@page "/blog"

@using System.Text;
@using Website.Shared.Models;
@using Website.Services.Interfaces;
@inject IBlogService _blogService;

<h3>Welcome on my blog!</h3>

@foreach (PostModel post in Blogs.Posts)
{
    <div class="card">
        <div class="card-header">
            @post.Title
        </div>
        <div class="card-body">
            @ConvertToHtml(post.Body)
        </div>
    </div>
}

@code {
    private int CurrentPage = 0;
    private int TotalPages = 10;
    private BlogsModel Blogs = new();

    protected override async Task OnInitializedAsync()
    {
        Blogs = await _blogService.GetAll(CurrentPage, TotalPages);
    }

    private MarkupString ConvertToHtml(string base64)
    {
        byte[] byteBody = Convert.FromBase64String(base64);
        string stringBody = Encoding.ASCII.GetString(byteBody);
        return new MarkupString(stringBody);
    }
}
